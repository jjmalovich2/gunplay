import{L as X}from"./kaplay-6e1-eYk4.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))d(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&d(s)}).observe(document,{childList:!0,subtree:!0});function u(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(t){if(t.ep)return;t.ep=!0;const c=u(t);fetch(t.href,c)}})();X({background:[141,183,255],global:!0});function ee(){loadRoot("./"),loadSprite("bean","/sprites/bean.png"),loadSprite("evil","/sprites/evil.png"),loadSprite("spike","/sprites/spike.png"),loadSprite("grass","/sprites/grass.png"),loadSprite("portal","/sprites/portal.png"),loadSprite("coin","/sprites/coin.png"),loadSprite("umbrella-hat","/sprites/umbrella_hat.png"),loadSprite("propeller-hat","/sprites/propeller_hat.png"),loadSprite("propeller","/sprites/propeller.png"),loadSprite("gun","/sprites/gun.png"),loadSprite("cursor","/sprites/cursor.png"),loadSound("coin","/examples/sounds/score.mp3"),loadSound("powerup","/examples/sounds/powerup.mp3"),loadSound("blip","/examples/sounds/blip.mp3"),loadSound("hit","/examples/sounds/hit.mp3"),loadSound("portal","/examples/sounds/portal.mp3")}function oe(a){const r=a.length,u=a[0].length,d=Array.from({length:r},()=>Array(u).fill(!1)),t=[];function c(s,i){let n=0,e=0;for(;s+n<u&&a[i][s+n]==="="&&!d[i][s+n];)n++;for(;i+e<r;){for(let l=0;l<n;l++)if(a[i+e][s+l]!=="="||d[i+e][s+l])return{x:s,y:i,width:n,height:e};e++}return{x:s,y:i,width:n,height:e}}for(let s=0;s<r;s++)for(let i=0;i<u;i++)if(a[s][i]==="="&&!d[s][i]){let n=c(i,s);t.push(n);for(let e=0;e<n.height;e++)for(let l=0;l<n.width;l++)d[s+e][i+l]=!0}return t}const te={GLOCK18:{recoil:8}};ee();setGravity(3200);document.addEventListener("click",()=>{canvas.requestPointerLock()});function re(a=60,r=1){return{id:"patrol",require:["pos","area"],add(){this.on("collide",(u,d)=>{(d.isLeft()||d.isRight())&&(r=-r)})},update(){this.move(a*r,0)}}}function se(){let a=0,r=!1,u=1;return{id:"big",require:["scale"],update(){r&&(a-=dt(),a<=0&&this.smallify()),this.scale=this.scale.lerp(vec2(u),dt()*6)},isBig(){return r},smallify(){u=1,a=0,r=!1},biggify(d){u=2,a=d,r=!0}}}const G=990,H=480,ae=2400;let v=2e3,E=te.GLOCK18;const R=[["                                =                ","                                =  =             ","         ==           =         =  =             ","      ========        =         =  =             ","                      =         =                ","                      =         =                ","================================================="],["                          $","                          $","                          $","                          $","                          $","           $$         =   $","         ====         =   $","                      =   $","                      =    ","       ^^      = >    =   @","==========================="],["     $    $    $    $     $","     $    $    $    $     $","                           ","                           ","                           ","                           ","                           "," ^^^^>^^^^>^^^^>^^^^>^^^^^@","==========================="]],le={tileWidth:64,tileHeight:64,tiles:{"=":()=>[sprite("grass"),anchor("bot"),offscreen({hide:!0}),"platform"],$:()=>[sprite("coin"),area(),pos(0,-9),anchor("bot"),offscreen({hide:!0}),"coin"],"^":()=>[sprite("spike"),area(),body({isStatic:!0}),anchor("bot"),offscreen({hide:!0}),"danger"],">":()=>[sprite("evil"),area(),anchor("bot"),body(),re(),offscreen({hide:!0}),"enemy"],"@":()=>[sprite("portal"),area({scale:.5}),anchor("bot"),pos(0,-12),offscreen({hide:!0}),"portal"]}};layers(["game","ui"],"game");scene("game",({levelId:a,coins:r}={levelId:0,coins:0})=>{const u=addLevel(R[a??0],le),d=oe(R[a]),t=64,c=-32,s=-64;function i(o,p,f,g){add([rect(f*t,g*t),pos(o*t+c,p*t+s),area(),body({isStatic:!0}),color(255,0,0),opacity(0),"p-hitbox"])}d.forEach(({x:o,y:p,width:f,height:g})=>{i(o,p,f,g)});const n=add([sprite("cursor"),pos(),layer("ui"),scale(1),anchor("center")]);setCursor("none");const e=add([rect(62,53),pos(0,0),area(),scale(1),body(),se(),anchor("center"),rotate(),"player",opacity(0)]),l=add([pos(e.pos.x,e.pos.y),sprite("bean"),anchor("center"),rotate(),"player-sprite"]),x=e.add([sprite("gun"),anchor(vec2(-2.3,-.75)),"gun",rotate()]);e.onUpdate(()=>{l.pos=vec2(e.pos.x,e.pos.y)});function T(o,p,f,g){let L=rand(7,12);const y=add([rect(L,L),color(74,34,11),pos(o,p-10),anchor("center"),area({collisionIgnore:["particle","player","spike","danger"],friction:.02,restitution:0}),"particle","small-particle",body(),lifespan(g,{fade:.5}),opacity(1)]);y.addForce(vec2(choose([rand(6e3,18e3),-rand(6e3,18e3)]),0).sub(y.vel).scale(y.mass*f)),y.jump(f*rand(800,1e3))}const j=1200,N=75;function V(o,p,f){const g=Vec2.fromAngle(f).scale(N),L=vec2(o,p).add(g),y=add([rect(10,5),color(141,145,141),pos(L),anchor("center"),area(),rotate(f),opacity(),move(Vec2.fromAngle(f),j),lifespan(1.1),"bullet"]);y.gravityScale=0,y.onCollide("p-hitbox",()=>{T(y.pos.x,y.pos.y,.1,.5),destroy(y)})}let P=!1;function A(){P&&(n.move(rand(-20*E.recoil,5*E.recoil),-8*100+rand(-20*E.recoil,20*E.recoil)),V(e.pos.x,e.pos.y,x.angle),wait(.05,A))}let K=vec2(e.pos.x,e.pos.y);onUpdate(()=>{x.angle=n.pos.sub(e.pos).angle(),x.flipY=Math.abs(x.angle)>90,n.move(mouseDeltaPos().scale(35));let o=vec2(e.pos.x,e.pos.y).sub(K);n.move(o.scale(60)),K=vec2(e.pos.x,e.pos.y),isMouseDown("left")?P||(P=!0,A()):P=!1});const I=.1,Z=.035,U=1.25,B=.7,w=500,q=5e3,W=550;let O=vec2(0,w);onUpdate(()=>{O=vec2(e.pos.x,Math.min(e.pos.y,w));const o=lerp(camPos().x,O.x,I),p=lerp(camPos().y,O.y,I),f=Math.min(Math.max(0,w-e.pos.y),q),g=Math.max(B,U-f/W*(U-B));camPos(o,p),camScale(g)}),onUpdate(()=>setCamPos(lerp(getCamPos(),e.worldPos(),Z))),e.onUpdate(()=>{e.pos.y>=ae&&go("lose"),e.vel.y>v&&(e.vel.y=v)}),e.onBeforePhysicsResolve(o=>{o.target.is(["platform","soft"])&&e.isJumping()&&o.preventResolution()}),e.onPhysicsResolve(()=>{}),e.onCollide("danger",()=>{go("lose"),play("hit")}),e.onCollide("portal",()=>{play("portal"),a+1<R.length?go("game",{levelId:a+1,coins:r}):go("win")}),e.onGround(o=>{o.is("enemy")&&(e.jump(G*1.5),destroy(o),addKaboom(e.pos),play("powerup"))}),e.onCollide("enemy",(o,p)=>{p!=null&&p.isBottom()||(go("lose"),play("hit"))});let _=!1;e.onHeadbutt(o=>{o.is("prize")&&!_&&(u.spawn("#",o.tilePos.sub(0,1)).jump(),_=!0,play("blip"))}),e.onCollide("apple",o=>{destroy(o),e.biggify(3),_=!1,play("powerup")});let b=0;onUpdate(()=>{b>0&&(b=Math.max(0,b-dt()*100))}),e.onCollide("coin",o=>{destroy(o),play("coin",{detune:b}),b+=100,r+=1,k.text=r});const k=add([text(r),pos(24,24),fixed()]);let m=!0,h=!1;async function D(){e.isGrounded()&&!h?(e.jump(G),m=!0):!e.isGrounded()&&m?(e.jump(G*.8),m=!1):h&&(m=!0)}let $=!0;function z(){e.isGrounded()||!$||e.vel.y>0&&(e.vel.y=0,l.sprite="umbrella-hat",e.gravityScale=.1,$=!1,wait(1,()=>{l.sprite="bean",e.gravityScale=1}))}function J(){let o=add([sprite("propeller"),pos(e.pos.x,e.pos.y-50),anchor("center"),area({collisionIgnore:["particle","player"],friction:.1,restitution:0}),"particle",body(),lifespan(.5,{fade:.5}),opacity(1),move(LEFT,rand(60,240)),rotate()]);o.jump(-e.vel.y+rand(200,400)),o.onUpdate(()=>o.angle-=90*dt())}let C=!0;function Y(){C&&(e.gravityScale=0,C=!1,m=!1,l.sprite="propeller-hat",e.vel.y=0,e.gravityScale=-.5,wait(.6,()=>{l.sprite="bean",J(),e.gravityScale=1}))}function Q(){for(let o=0;o<rand(5,7);o++)T(e.pos.x,e.pos.y,1,2)}e.on("ground",()=>{l.sprite="bean",e.gravityScale=1,$=!0,C=!0}),e.onCollide("p-hitbox",()=>{e.vel.y>=v&&(Q(),console.log("SLAMMED!"))});let M=0,S=!1;e.onCollideUpdate("p-hitbox",()=>{e.isGrounded()&&(e.gravityScale=1),!e.isGrounded()&&e.vel.y>=0&&S?(e.vel.y=0,v=500,h=!0,l.rotateTo(30*M),h&&e.onCollideEnd(()=>{e.gravityScale=1,v=2e3,h=!1,l.rotateTo(0),m=!0})):(e.gravityScale=1,v=2e3,l.rotateTo(0))});let F;e.onCollide("p-hitbox",(o,p)=>{p.isLeft()?F=RIGHT:F=LEFT}),loop(.15,()=>{h&&add([pos(e.pos.x-16,e.pos.y-32),rect(8,8),color(74,34,11),anchor("center"),area({collisionIgnore:["particle","player","danger","enemy"]}),body(),lifespan(.5,{fade:.5}),opacity(1),move(F,rand(100,150)),"particle"])}),onKeyPress("w",()=>{D()}),onKeyPress("space",z),onKeyPress("c",()=>{e.isGrounded()||Y()}),onKeyDown("a",()=>{e.move(-480,0),S=!0,M=1}),onKeyRelease("a",()=>{S=!1}),onKeyDown("d",()=>{e.move(H,0),S=!0,M=-1}),onKeyRelease("d",()=>{S=!1}),onKeyPress("s",()=>{e.gravityScale=3}),onKeyRelease("s",()=>{e.gravityScale=1}),onGamepadButtonPress("south",D),onGamepadStick("left",o=>{e.move(o.x*H,0)}),onKeyPress("f",()=>{setFullscreen(!isFullscreen())})});scene("lose",()=>{add([text("You Lose")]),onKeyPress(()=>go("game"))});scene("win",()=>{add([text("You Win")]),onKeyPress(()=>go("game"))});go("game");
//# sourceMappingURL=index-DW8nENOg.js.map
